___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Adhoc Pixel",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZAAAAGQCAYAAACAvzbMAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAE/GlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CiAgICAgICAgPHJkZjpSREYgeG1sbnM6cmRmPSdodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjJz4KCiAgICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICAgICAgICB4bWxuczpkYz0naHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8nPgogICAgICAgIDxkYzp0aXRsZT4KICAgICAgICA8cmRmOkFsdD4KICAgICAgICA8cmRmOmxpIHhtbDpsYW5nPSd4LWRlZmF1bHQnPkFkaG9jUGx1Z2luTG9nbyZhcG9zO3MgLSBBZGhvY0F1dGg8L3JkZjpsaT4KICAgICAgICA8L3JkZjpBbHQ+CiAgICAgICAgPC9kYzp0aXRsZT4KICAgICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KCiAgICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICAgICAgICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogICAgICAgIDxBdHRyaWI6QWRzPgogICAgICAgIDxyZGY6U2VxPgogICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI0LTA3LTA4PC9BdHRyaWI6Q3JlYXRlZD4KICAgICAgICA8QXR0cmliOkV4dElkPjRlMmQyMTE1LWU3YjUtNGEzZi05M2Y0LWQwOTA5ZjhmMjAwNzwvQXR0cmliOkV4dElkPgogICAgICAgIDxBdHRyaWI6RmJJZD41MjUyNjU5MTQxNzk1ODA8L0F0dHJpYjpGYklkPgogICAgICAgIDxBdHRyaWI6VG91Y2hUeXBlPjI8L0F0dHJpYjpUb3VjaFR5cGU+CiAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgPC9yZGY6U2VxPgogICAgICAgIDwvQXR0cmliOkFkcz4KICAgICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KCiAgICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICAgICAgICB4bWxuczpwZGY9J2h0dHA6Ly9ucy5hZG9iZS5jb20vcGRmLzEuMy8nPgogICAgICAgIDxwZGY6QXV0aG9yPkRhaW08L3BkZjpBdXRob3I+CiAgICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CgogICAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PScnCiAgICAgICAgeG1sbnM6eG1wPSdodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvJz4KICAgICAgICA8eG1wOkNyZWF0b3JUb29sPkNhbnZhIChSZW5kZXJlcik8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgICAKICAgICAgICA8L3JkZjpSREY+CiAgICAgICAgPC94OnhtcG1ldGE+4xiolgAAJjZJREFUeJzs3Xt0VdWBx/FfbnJvSEhCEiFCeIeXFEHsFBARRnGJiBVwVEABsatT+5rWaac6Xc50Hp3+05npy8eMD0QDqAGKD7RStRUfmCqKIgSCaSPyDBECCY+8c+/8wboMYkju3fecu8+5fD9ruZaQ3LN/ayn5sc8+Z++0SCQSEQAAcQrYDgAA8CcKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAAAEYoEACAEQoEAGCEAgEAGKFAAABGKBAAgBEKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAAAEYoEACAEQoEAGCEAgEAGKFAAABGKBAAgBEKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAAAEYoEACAEQoEAGCEAgEAGKFAAABGKBAAgBEKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAAAEYoEACAEQoEAGCEAgEAGKFAAABGKBAAgBEKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAAAEYoEACAEQoEAGCEAgEAGKFAAABGKBAAgBEKBABghAIBABihQAAARigQAIARCgQAYIQCAQAYoUAA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"
  },
  "description": "",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "API Key",
    "displayName": "API Key",
    "simpleValueType": true
  },
  {
    "type": "SELECT",
    "name": "eventType",
    "displayName": "lead",
    "macrosInSelect": true,
    "selectItems": [
      {
        "value": "lead",
        "displayValue": "Lead"
      },
      {
        "value": "purchase",
        "displayValue": "Purchase"
      }
    ],
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const sendHttpRequest = require('sendHttpRequest');
const getTimestampMillis = require('getTimestampMillis');
const encodeUriComponent = require('encodeUriComponent');
const getReferrerUrl = require('getReferrerUrl');
const getUrl = require('getUrl');
const getQueryParameters = require('getQueryParameters');
const JSON = require('JSON');
const copyFromDataLayer = require('copyFromDataLayer');
const logToConsole = require('logToConsole');

const apiKey = data.apiKey;
const eventType = data.eventType || 'purchase';
const referrer = data.referrer || getReferrerUrl();
const currentUrl = data.currentUrl || getUrl();

let pixelData = {
    apiKeyId: apiKey,
    event: eventType,
    referrer: referrer,
    url: currentUrl,
    utm_source: getQueryParameters('utm_source'),
    utm_medium: getQueryParameters('utm_medium'),
    utm_campaign: getQueryParameters('utm_campaign'),
    utm_term: getQueryParameters('utm_term'),
    utm_content: getQueryParameters('utm_content'),
    timestamp: getTimestampMillis()
};

const ecommerceData = copyFromDataLayer('ecommerce');
if (ecommerceData && ecommerceData.purchase) {
    pixelData.transaction_id = ecommerceData.purchase.actionField.id;
    pixelData.value = ecommerceData.purchase.actionField.revenue;
    pixelData.currency = ecommerceData.currencyCode;
    pixelData.products = JSON.stringify(ecommerceData.purchase.products);
}

const url = 'https://jck4ajyzc2.execute-api.eu-north-1.amazonaws.com/dev/PostPurchase';
const requestOptions = {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-Api-Key': apiKey
    }
};

sendHttpRequest(url, (statusCode, headers, body) => {
    if (statusCode >= 200 && statusCode < 300) {
        logToConsole('Data successfully sent to Lambda');
        data.gtmOnSuccess();
    } else {
        logToConsole('Failed to send data to Lambda:', body);
        data.gtmOnFailure();
    }
}, requestOptions, JSON.stringify(pixelData));


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "get_referrer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedKeys",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: '1'
  code: |-
    let testData = {};

    mock('sendHttpRequest', function(url, callback, options, body) {
      testData.url = url;
      testData.options = options;
      testData.body = body;
      callback(200, {}, 'Success');
    });

    mock('getQueryParameters', function(param) {
      const params = {
        utm_source: 'test_source',
        utm_medium: 'test_medium',
        utm_campaign: 'test_campaign',
        utm_term: 'test_term',
        utm_content: 'test_content'
      };
      return params[param] || '';
    });

    mock('copyFromDataLayer', function() {
      return {
        currencyCode: 'EUR',
        purchase: {
          actionField: {
            id: 'T12345',
            revenue: '100.00'
          },
          products: [{
            name: 'Test Product',
            id: 'SKU123',
            price: '100.00',
            quantity: 1
          }]
        }
      };
    });

    mock('getReferrerUrl', function() {
      return 'https://www.example.com';
    });

    mock('getUrl', function() {
      return 'https://www.yourstore.com/checkout';
    });

    mock('data', {
      apiKey: 'e52dIIdvUZ0i837UiqE7HmAK8aW9r6',
      eventType: 'purchase',
      gtmOnSuccess: function() { testData.success = true; },
      gtmOnFailure: function() { testData.success = false; }
    });
setup: |-
  let testData = {};

  mock('sendHttpRequest', function(url, callback, options, body) {
    testData.url = url;
    testData.options = options;
    testData.body = body;
    callback(200, {}, 'Success');
  });

  mock('getQueryParameters', function(param) {
    const params = {
      utm_source: 'test_source',
      utm_medium: 'test_medium',
      utm_campaign: 'test_campaign',
      utm_term: 'test_term',
      utm_content: 'test_content'
    };
    return params[param] || '';
  });

  mock('copyFromDataLayer', function() {
    return {
      currencyCode: 'EUR',
      purchase: {
        actionField: {
          id: 'T12345',
          revenue: '100.00'
        },
        products: [{
          name: 'Test Product',
          id: 'SKU123',
          price: '100.00',
          quantity: 1
        }]
      }
    };
  });

  mock('getReferrerUrl', function() {
    return 'https://www.example.com';
  });

  mock('getUrl', function() {
    return 'https://www.yourstore.com/checkout';
  });

  mock('data', {
    apiKey: 'e52dIIdvUZ0i837UiqE7HmAK8aW9r6',
    eventType: 'purchase',
    gtmOnSuccess: function() { testData.success = true; },
    gtmOnFailure: function() { testData.success = false; }
  });


___NOTES___

Created on 23-9-2024, 19:01:21


